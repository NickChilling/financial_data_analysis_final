setwd("c:/Users/AresL/Desktop/financial_data_analysis_final/data")
library(tseries)
library(forecast)
da1 = read.csv("上证50.csv", header = T)
head(da1)
logSZ50Pri = log((da1[c(168: 2167), 3]))
head(logSZ50Pri)
tdx = c(1: 2000)/250 + 2010
plot(tdx, logSZ50Pri, xlab = 'day', ylab = 'ln(price)', type='l')
title(main = '上证50指数变化')
dlogSZ50Pri = diff(logSZ50Pri) #做一阶差分
adf.test(dlogSZ50Pri) # 在5%的显著水平下拒绝原假设，一阶差分后数据平稳
par(mfcol = c(1, 2))
acf(dlogSZ50Pri, lag = 20)
pacf(dlogSZ50Pri, lag = 20)
# 观察数据ar使用3阶，ma采用两阶，建立arima(3, 0, 2)模型
SZ50_model = arima(dlogSZ50Pri, order = c(3, 0, 2), include.mean = F)
SZ50_model
Box.test(SZ50_model$residuals) #
# 计算短期百分比误差的绝对值之和
SZ50_arima_forecast = forecast(SZ50_model, h = 5)
SZ50_arima_forecast
dim(SZ50_arima_forecast)
length(SZ50_arima_forecast)
SZ50_arima_forecast[1]
SZ50_arima_forecast[4]
dim(SZ50_arima_forecast[4])
length(SZ50_arima_forecast[4])
SZ50_arima_forecast[1][4]
SZ50_arima_forecast[1][2]
typeof(SZ50_arima_forecast[4])
test = SZ50_arima_forecast[4]
test[1]
SZ50_arima_forecast[[1]]
SZ50_arima_forecast[[4]]
SZ50_arima_forecast[[4]][1]
logr = diff(log(da1[,3]))
?forecast
#计算原本数据的对数收益率
logr = diff(log(da1[c(2168:2468), 3]))
head(logr)
for(i in 1: 5) {
sum = sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
typeof(SZ50_arima_forecast[[4]][1])
typeof(SZ50_arima_forecast[4][1])
for(i in 1: 5) {
sum = sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
logr[1]
dim(SZ50_arima_forecast[[4]][1])
length(SZ50_arima_forecast[[4]][1])
SZ50_arima_forecast[[4]][1]
for(i in 1: 4) {
sum = sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
for(i in 1: 4) {
sum = sum + abs(1 - logr[i])
}
for(i in 1: 5) {
di_sum = di_sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
di_sum = 0
for(i in 1: 5) {
di_sum = di_sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
di_sum
short_di_sum = 0
for(i in 1: 5) {
short_di_sum = short_di_sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
short_di_sum
SZ50_arima_forecast = forecast(SZ50_model, h = 250)
head(logr)
short_di_sum = 0
for(i in 1: 5) {
short_di_sum = short_di_sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
short_di_sum
middle_di_sum = 0
for(i in 1: 60) {
middle_di_sum = middle_di_sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
middle_di_sum
long_di_sum = 0
for(i in 1: 5) {
long_di_sum = long_di_sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
long_di_sum
for(i in 1: 250) {
long_di_sum = long_di_sum + abs(SZ50_arima_forecast[[4]][i] - logr[i])
}
long_di_sum
